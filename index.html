<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>أنصاري | رفيقك في الذكر</title>

    <!-- Mobile Luxury Optimizations -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon-192.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;700;900&family=Inter:wght@400;700;900&family=Outfit:wght@500;700;900&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Luxury Splash Screen -->
    <div id="splash-screen">
        <div class="splash-content">
            <img src="app_logo.svg" alt="أنصاري" class="splash-logo floating-icon">
            <div class="splash-loader"></div>
        </div>
    </div>

    <div id="app">
        <!-- Persistent Header -->
        <header class="app-header">
            <div class="logo-container">
                <h1 class="app-name">أنصاري</h1>
                <p id="app-subtitle">رحلتك الإيمانية اليومية</p>
            </div>
            <button id="theme-toggle" class="icon-btn" onclick="toggleTheme()" aria-label="تبديل المظهر">
                <i class="ph-fill ph-moon-stars"></i>
            </button>
        </header>

        <main id="main-content">
            <!-- VIEW: HOME -->
            <div id="view-home" class="view-section fade-in">
                <!-- Daily Dashboard Summary -->
                <div class="dashboard-section" style="padding: 0 1.5rem; margin-bottom: 2rem;">
                    <div class="dashboard-card ripple-card">
                        <div class="dash-item">
                            <i class="ph-fill ph-target"></i>
                            <div class="dash-text">
                                <span id="total-dhikr-today">0</span>
                                <small>ذكر اليوم</small>
                            </div>
                        </div>
                        <div class="dash-divider"></div>
                        <div class="dash-item">
                            <i class="ph-fill ph-fire"></i>
                            <div class="dash-text">
                                <span id="streak-count">1</span>
                                <small>يوم متواصل</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Global Search -->
                <div class="search-container" style="padding: 0 1.5rem; margin-bottom: 2.5rem;">
                    <div class="search-bar-luxury">
                        <i class="ph ph-magnifying-glass"></i>
                        <input type="text" id="global-search" placeholder="ابحث عن ذكر أو دعاء..."
                            oninput="handleSearch()">
                        <button id="clear-search" class="hidden" onclick="clearSearch()"><i
                                class="ph ph-x"></i></button>
                    </div>
                </div>

                <!-- Search Results (Search Mode) -->
                <div id="search-results-view" class="section-container hidden">
                    <h2 class="section-title">نتائج البحث</h2>
                    <div id="search-results-list" class="search-list"></div>
                </div>

                <div id="home-default-content">
                    <!-- Main Hero Adhkar -->
                    <div class="hero-section">
                        <div class="hero-card morning" onclick="openAdhkar('morning')">
                            <i class="ph-fill ph-sun hero-icon"></i>
                            <div class="hero-text">
                                <h3>أذكار الصباح</h3>
                                <p>نور ليومك</p>
                            </div>
                        </div>
                        <div class="hero-card evening" onclick="openAdhkar('evening')">
                            <i class="ph-fill ph-moon-stars hero-icon"></i>
                            <div class="hero-text">
                                <h3>أذكار المساء</h3>
                                <p>حفظ لليلتك</p>
                            </div>
                        </div>
                    </div>

                    <!-- Daily Essentials Grid -->
                    <div class="section-container">
                        <h2 class="section-title">زاد المؤمن</h2>
                        <div class="categories-grid">
                            <div class="category-card" onclick="openAdhkar('post_prayer')">
                                <i class="ph-fill ph-hands-praying"></i>
                                <span class="category-title">بعد الصلاة</span>
                            </div>
                            <div class="category-card" onclick="openAdhkar('sleep')">
                                <i class="ph-fill ph-moon"></i>
                                <span class="category-title">أذكار النوم</span>
                            </div>
                            <div class="category-card" onclick="showView('allah-names')">
                                <i class="ph-fill ph-star"></i>
                                <span class="category-title">الأسماء الحسنى</span>
                            </div>
                        </div>
                    </div>

                    <!-- Situational Adhkar -->
                    <div class="section-container">
                        <h2 class="section-title">أذكار وتسابيح</h2>
                        <div class="categories-grid">
                            <div class="category-card" onclick="openAdhkar('prophetic_duas')">
                                <i class="ph-fill ph-scroll"></i>
                                <span class="category-title">أدعية نبوية</span>
                            </div>
                            <div class="category-card" onclick="openAdhkar('quranic_duas')">
                                <i class="ph-fill ph-book-open"></i>
                                <span class="category-title">أدعية قرآنية</span>
                            </div>
                            <div class="category-card" onclick="openAdhkar('travel')">
                                <i class="ph-fill ph-airplane-tilt"></i>
                                <span class="category-title">أذكار السفر</span>
                            </div>
                            <div class="category-card" onclick="openAdhkar('mosque')">
                                <i class="ph-fill ph-mosque"></i>
                                <span class="category-title">المسجد</span>
                            </div>
                            <div class="category-card" onclick="openAdhkar('house')">
                                <i class="ph-fill ph-house-line"></i>
                                <span class="category-title">المنزل</span>
                            </div>
                            <div class="category-card" onclick="openAdhkar('duas_kurb')">
                                <i class="ph-fill ph-shield-warning"></i>
                                <span class="category-title">أدعية الكرب</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: ADHKAR DETAIL -->
            <div id="view-adhkar" class="view-section hidden fade-in">
                <div class="view-header"
                    style="padding: 0 1.5rem; margin-bottom: 2rem; display: flex; align-items: center; justify-content: space-between;">
                    <button class="icon-btn" onclick="showView('home')"><i class="ph ph-caret-right"></i></button>
                    <h2 id="adhkarTitle" class="section-title" style="margin: 0; flex: 1; text-align: center;">الأذكار
                    </h2>
                    <div class="header-utils" style="display: flex; gap: 0.5rem;">
                        <button onclick="decreaseFont()" class="icon-btn" title="تصغير الخط"><i
                                class="ph ph-minus"></i></button>
                        <button onclick="increaseFont()" class="icon-btn" title="تكبير الخط"><i
                                class="ph ph-plus"></i></button>
                    </div>
                </div>

                <div class="reading-progress-container" style="margin: 0 1.5rem 1.5rem;">
                    <div class="reading-progress"
                        style="height: 6px; background: rgba(0,0,0,0.05); border-radius: 3px; overflow: hidden;">
                        <div id="dhikr-progress-bar" class="progress-fill"
                            style="height: 100%; background: var(--primary); width: 0%; border-radius: 3px; transition: width 0.3s ease;">
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                        <span id="dhikr-index-info"
                            style="font-size: 0.75rem; font-weight: 700; color: var(--text-muted);">1 / 10</span>
                        <span id="dhikr-repeat-info"
                            style="font-size: 0.75rem; font-weight: 700; color: var(--primary);">التكرار: 3</span>
                    </div>
                </div>

                <div class="dhikr-card">
                    <p id="dhikrText" class="dhikr-arabic">جاري التحميل...</p>
                    <div class="dhikr-actions" style="display: flex; gap: 1rem; margin-top: 2rem;">
                        <button id="fav-btn" onclick="toggleFavorite()" class="icon-btn"><i
                                class="ph ph-heart"></i></button>
                        <button class="icon-btn" onclick="playAudio()"><i class="ph-fill ph-speaker-high"></i></button>
                    </div>
                </div>

                <div class="counter-area" style="text-align: center; margin-top: 2.5rem;">
                    <button id="dhikr-progress-btn" onclick="incrementDhikr()" class="counter-button">0</button>
                    <div class="nav-controls"
                        style="display: flex; justify-content: space-between; padding: 2rem 3rem;">
                        <button onclick="prevDhikr()" class="icon-btn"><i class="ph ph-arrow-right"></i></button>
                        <button onclick="nextDhikr()" class="icon-btn"><i class="ph ph-arrow-left"></i></button>
                    </div>
                </div>
            </div>

            <!-- VIEW: TASBEEH -->
            <div id="view-tasbeeh" class="view-section hidden fade-in">
                <div class="tasbeeh-bg-pattern"></div>

                <div class="view-header"
                    style="text-align: center; margin-bottom: 2rem; position: relative; z-index: 10;">
                    <h2 class="section-title" style="justify-content: center;">السبحة الإلكترونية</h2>
                </div>

                <!-- Tasbeeh Themes & Controls -->
                <div class="tasbeeh-themes"
                    style="display: flex; justify-content: center; gap: 0.8rem; margin-bottom: 1.5rem; padding: 0 1.5rem; overflow-x: auto; position: relative; z-index: 10;">
                    <div class="theme-dot active" style="background: var(--primary);"
                        onclick="setTasbeehTheme('emerald', this)"></div>
                    <div class="theme-dot" style="background: #3b82f6;" onclick="setTasbeehTheme('blue', this)"></div>
                    <div class="theme-dot" style="background: #8b5cf6;" onclick="setTasbeehTheme('purple', this)"></div>
                    <div class="theme-dot" style="background: #f43f5e;" onclick="setTasbeehTheme('rose', this)"></div>
                    <div class="theme-dot" style="background: #f59e0b;" onclick="setTasbeehTheme('amber', this)"></div>
                </div>

                <!-- Tasbeeh Controls -->
                <div class="tasbeeh-controls-row"
                    style="display: flex; justify-content: space-between; align-items: center; padding: 0 1.5rem; margin-bottom: 1rem; position: relative; z-index: 10;">
                    <div class="target-chips" style="display:flex; gap: 0.4rem;">
                        <button class="chip active" onclick="setTasbeehTarget(33, this)">33</button>
                        <button class="chip" onclick="setTasbeehTarget(100, this)">100</button>
                        <button class="chip" onclick="setTasbeehTarget(0, this)"><i class="ph ph-infinity"></i></button>
                    </div>
                    <div class="vibe-sound-controls" style="display:flex; gap: 0.5rem;">
                        <button id="ts-sound-btn" class="util-btn" onclick="toggleTSSound()"><i
                                class="ph ph-speaker-high"></i></button>
                        <button id="ts-vibe-btn" class="util-btn active" onclick="toggleTSVibe()"><i
                                class="ph ph-vibrate"></i></button>
                    </div>
                </div>

                <div class="tasbeeh-display-card" style="position: relative; z-index: 10;">
                    <div class="tasbeeh-display" style="text-align: center; margin-bottom: 1rem;">
                        <p id="current-tasbeeh-label"
                            style="font-size: 1.2rem; color: var(--primary); margin-bottom: 0px; font-weight: 800; font-family: 'Amiri', serif;">
                            سبحان
                            الله</p>
                        <div class="counter-glow-wrapper">
                            <h2 id="tasbeeh-counter" class="tasbeeh-number">0</h2>
                        </div>
                    </div>

                    <div style="display: flex; flex-direction: column; align-items: center; gap: 1.5rem;">
                        <div class="tasbeeh-visual-container">
                            <!-- Animated Beads Circle -->
                            <div id="beads-circle" class="beads-circle">
                                <!-- 33 beads will be injected here via JS -->
                            </div>

                            <div class="counter-container">
                                <button id="tasbeeh-btn" onclick="incrementTasbeeh()" class="tasbeeh-main-btn">
                                    <div class="btn-ripple"></div>
                                    <i class="ph-fill ph-hand-tap"></i>
                                </button>
                                <div class="progress-ring">
                                    <svg width="250" height="250">
                                        <circle class="progress-ring__circle" stroke="var(--primary)" stroke-width="6"
                                            fill="transparent" r="118" cx="125" cy="125" />
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center;">
                            <span id="tasbeeh-daily-total"
                                style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1.2rem; font-weight: 700;">إجمالي
                                اليوم: 0</span>
                            <button onclick="resetTasbeeh()" class="reset-btn-luxury">
                                <i class="ph ph-arrows-counter-clockwise"></i>
                                <span>تصفير العداد</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- VIEW: ALLAH NAMES -->
            <div id="view-allah-names" class="view-section hidden fade-in">
                <div class="view-header"
                    style="text-align: center; margin-bottom: 2rem; display: flex; align-items: center; justify-content: space-between; padding: 0 1.5rem;">
                    <button class="icon-btn" onclick="showView('home')"><i class="ph ph-caret-right"></i></button>
                    <h2 class="section-title" style="margin: 0; flex: 1; text-align: center;">أسماء الله الحسنى</h2>
                    <div style="width: 40px;"></div>
                </div>
                <div id="names-grid" class="names-grid"
                    style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; padding: 0 1.5rem 2rem;">
                    <!-- Names dynamically injected -->
                </div>
            </div>

            <!-- Floating Quick Tasbeeh Button -->
            <button id="floating-tasbeeh" class="floating-btn" onclick="showView('tasbeeh')">
                <i class="ph-fill ph-hand-tap"></i>
            </button>
            <!-- VIEW: FAVORITES -->
            <div id="view-favorites" class="view-section hidden fade-in">
                <div class="view-header"
                    style="padding: 0 1.5rem; margin-bottom: 2rem; display: flex; align-items: center; justify-content: space-between;">
                    <button class="icon-btn" onclick="showView('home')"><i class="ph ph-caret-right"></i></button>
                    <h2 class="section-title" style="margin: 0; flex: 1; text-align: center;">المفضلات</h2>
                    <div style="width: 40px;"></div>
                </div>
                <div id="favorites-list" class="favorites-container" style="padding: 0 1.5rem 2rem;">
                    <!-- Favorites dynamically injected -->
                    <div class="empty-state" style="text-align: center; padding: 4rem 1.5rem;">
                        <i class="ph ph-heart-break"
                            style="font-size: 3.5rem; color: var(--text-muted); opacity: 0.3;"></i>
                        <p style="margin-top: 1.5rem; color: var(--text-muted); font-weight: 600;">لا توجد أذكار مفضلة
                            حالياً</p>
                    </div>
                </div>
            </div>

            <div id="view-settings" class="view-section hidden fade-in">
                <h2 class="section-title" style="padding: 0 1.5rem; margin-bottom: 2rem;">الإعدادات</h2>
                <div class="settings-container" style="padding: 0 1.5rem;">

                    <!-- Reminders Block -->
                    <div class="settings-group" style="margin-bottom: 2rem;">
                        <h3 style="font-size: 1rem; color: var(--text-muted); margin-bottom: 1rem; font-weight: 700;">
                            التنبيهات والذكير</h3>
                        <div class="settings-item" onclick="toggleReminderPermission()">
                            <div class="settings-info">
                                <span>تفعيل التنبيهات الذكية</span>
                                <small style="display: block; font-size: 0.75rem; color: var(--text-muted);">للتذكير
                                    بالأذكار والسنن</small>
                            </div>
                            <div class="switch">
                                <input type="checkbox" id="reminder-checkbox">
                                <span class="slider"></span>
                            </div>
                        </div>
                        <div id="reminder-frequency" class="settings-sub-item hidden">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                                <span>تكرار التنبيه</span>
                                <select id="reminder-interval" class="luxury-select"
                                    onchange="updateReminderInterval()">
                                    <option value="30">كل 30 دقيقة</option>
                                    <option value="60">كل ساعة</option>
                                    <option value="120">كل ساعتين</option>
                                    <option value="morning_evening">الصباح والمساء فقط</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3 style="font-size: 1rem; color: var(--text-muted); margin-bottom: 1rem; font-weight: 700;">
                            عام</h3>
                        <div class="settings-item" onclick="toggleTheme()">
                            <span>الوضع الليلي</span>
                            <div class="switch">
                                <input type="checkbox" id="theme-checkbox">
                                <span class="slider"></span>
                            </div>
                        </div>
                        <div class="settings-item" onclick="toggleLanguage()">
                            <span>اللغة / Language</span>
                            <span id="current-lang-text" style="font-weight: 900; color: var(--primary);">العربية</span>
                        </div>
                        <div class="settings-item" onclick="resetAllData()"
                            style="border: 1px solid rgba(239, 68, 68, 0.2); background: rgba(239, 68, 68, 0.05);">
                            <span style="color: #ef4444;">مسح كافة البيانات</span>
                            <i class="ph ph-trash" style="color: #ef4444;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Premium Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="showView('home')" id="nav-home">
                <i class="ph ph-house"></i>
                <span id="nav-label-home">الرئيسية</span>
            </button>
            <button class="nav-item" onclick="showView('tasbeeh')" id="nav-tasbeeh">
                <i class="ph ph-hand-tap"></i>
                <span id="nav-label-tasbeeh">سبحة</span>
            </button>
            <button class="nav-item" onclick="showView('favorites')" id="nav-favorites">
                <i class="ph ph-heart"></i>
                <span id="nav-label-favorites">مفضلات</span>
            </button>
            <button class="nav-item" onclick="showView('settings')" id="nav-settings">
                <i class="ph ph-gear"></i>
                <span id="nav-label-settings">ضبط</span>
            </button>
        </nav>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script src="data.js"></script>
    <script src="script.js"></script>
</body>

</html>